<html>
      <head>
        <meta charset="UTF-8">
        <title>Readme.md</title>
      </head>
      <body>
        <h1 id="engine-io-parser">engine.io-parser</h1>
<p><a href="http://travis-ci.org/socketio/engine.io-parser"><img src="https://secure.travis-ci.org/socketio/engine.io-parser.svg" alt="Build Status"></a>
<a href="http://badge.fury.io/js/engine.io-parser"><img src="https://badge.fury.io/js/engine.io-parser.svg" alt="NPM version"></a></p>
<p>This is the JavaScript parser for the engine.io protocol encoding,
shared by both
<a href="https://github.com/socketio/engine.io-client">engine.io-client</a> and
<a href="https://github.com/socketio/engine.io">engine.io</a>.</p>
<h2 id="how-to-use">How to use</h2>
<h3 id="standalone">Standalone</h3>
<p>The parser can encode/decode packets, payloads, and payloads as binary
with the following methods: <code>encodePacket</code>, <code>decodePacket</code>, <code>encodePayload</code>,
<code>decodePayload</code>, <code>encodePayloadAsBinary</code>, <code>decodePayloadAsBinary</code>.</p>
<p>The browser-side parser also includes <code>encodePayloadAsArrayBuffer</code> and <code>encodePayloadAsBlob</code>.</p>
<p>Example:</p>
<pre><code class="lang-js">var parser = require(&#39;engine.io-parser&#39;);

var data = new Buffer(5);
for (var i = 0; i &lt; data.length; i++) { data[i] = i; }

parser.encodePacket({ type: &#39;message&#39;, data: data }, function(encoded) {
  var decodedData = parser.decodePacket(encoded); // { type: &#39;message&#39;, data: data }
});
</code></pre>
<h3 id="with-browserify">With browserify</h3>
<p>Engine.IO Parser is a commonjs module, which means you can include it by using
<code>require</code> on the browser and package using <a href="http://browserify.org/">browserify</a>:</p>
<ol>
<li><p>install the parser package</p>
<pre><code class="lang-shell"> npm install engine.io-parser
</code></pre>
</li>
<li><p>write your app code</p>
<pre><code class="lang-js"> var parser = require(&#39;engine.io-parser&#39;);

 var testBuffer = new Int8Array(10);
 for (var i = 0; i &lt; testBuffer.length; i++) testBuffer[i] = i;

 var packets = [{ type: &#39;message&#39;, data: testBuffer.buffer }, { type: &#39;message&#39;, data: &#39;hello&#39; }];

 parser.encodePayload(packets, function(encoded) {
   parser.decodePayload(encoded,
     function(packet, index, total) {
       var isLast = index + 1 == total;
       if (!isLast) {
         var buffer = new Int8Array(packet.data); // testBuffer
       } else {
         var message = packet.data; // &#39;hello&#39;
       }
     });
 });
</code></pre>
</li>
<li><p>build your app bundle</p>
<pre><code class="lang-bash"> $ browserify app.js &gt; bundle.js
</code></pre>
</li>
<li><p>include on your page</p>
<pre><code class="lang-html"> &lt;script src=&quot;/path/to/bundle.js&quot;&gt;&lt;/script&gt;
</code></pre>
</li>
</ol>
<h2 id="features">Features</h2>
<ul>
<li>Runs on browser and node.js seamlessly</li>
<li>Runs inside HTML5 WebWorker</li>
<li>Can encode and decode packets<ul>
<li>Encodes from/to ArrayBuffer or Blob when in browser, and Buffer or ArrayBuffer in Node</li>
</ul>
</li>
</ul>
<h2 id="api">API</h2>
<p>Note: <code>cb(type)</code> means the type is a callback function that contains a parameter of type <code>type</code> when called.</p>
<h3 id="node">Node</h3>
<ul>
<li><code>encodePacket</code><ul>
<li>Encodes a packet.</li>
<li><strong>Parameters</strong><ul>
<li><code>Object</code>: the packet to encode, has <code>type</code> and <code>data</code>.<ul>
<li><code>data</code>: can be a <code>String</code>, <code>Number</code>, <code>Buffer</code>, <code>ArrayBuffer</code></li>
</ul>
</li>
<li><code>Boolean</code>: optional, binary support</li>
<li><code>Function</code>: callback, returns the encoded packet (<code>cb(String)</code>)</li>
</ul>
</li>
</ul>
</li>
<li><p><code>decodePacket</code></p>
<ul>
<li>Decodes a packet. Data also available as an ArrayBuffer if requested.</li>
<li>Returns data as <code>String</code> or (<code>Blob</code> on browser, <code>ArrayBuffer</code> on Node)</li>
<li><strong>Parameters</strong><ul>
<li><code>String</code> | <code>ArrayBuffer</code>: the packet to decode, has <code>type</code> and <code>data</code></li>
<li><code>String</code>: optional, the binary type</li>
</ul>
</li>
</ul>
</li>
<li><p><code>encodeBase64Packet</code></p>
<ul>
<li>Encodes a packet with binary data in a base64 string (<code>String</code>)</li>
<li><strong>Parameters</strong><ul>
<li><code>Object</code>: the packet to encode, has <code>type</code> and <code>data</code></li>
<li><code>Function</code>: callback, returns the base64 encoded message (<code>cb(String)</code>)</li>
</ul>
</li>
</ul>
</li>
<li><p><code>decodeBase64Packet</code></p>
<ul>
<li>Decodes a packet encoded in a base64 string.</li>
<li><strong>Parameters</strong><ul>
<li><code>String</code>: the base64 encoded message</li>
<li><code>String</code>: optional, the binary type</li>
</ul>
</li>
</ul>
</li>
<li><p><code>encodePayload</code></p>
<ul>
<li>Encodes multiple messages (payload).</li>
<li>If any contents are binary, they will be encoded as base64 strings. Base64
encoded strings are marked with a b before the length specifier</li>
<li><strong>Parameters</strong><ul>
<li><code>Array</code>: an array of packets</li>
<li><code>Boolean</code>: optional, binary support</li>
<li><code>Function</code>: callback, returns the encoded payload (<code>cb(String)</code>)</li>
</ul>
</li>
</ul>
</li>
<li><p><code>decodePayload</code></p>
<ul>
<li>Decodes data when a payload is maybe expected. Possible binary contents are
decoded from their base64 representation.</li>
<li><strong>Parameters</strong><ul>
<li><code>String</code>: the payload</li>
<li><code>String</code>: optional, the binary type</li>
<li><code>Function</code>: callback, returns (cb(<code>Object</code>: packet, <code>Number</code>:packet index, <code>Number</code>:packet total))</li>
</ul>
</li>
</ul>
</li>
<li><p><code>encodePayloadAsBinary</code></p>
<ul>
<li>Encodes multiple messages (payload) as binary.</li>
<li><strong>Parameters</strong><ul>
<li><code>Array</code>: an array of packets</li>
<li><code>Function</code>: callback, returns the encoded payload (<code>cb(Buffer)</code>)</li>
</ul>
</li>
</ul>
</li>
<li><code>decodePayloadAsBinary</code><ul>
<li>Decodes data when a payload is maybe expected. Strings are decoded by
interpreting each byte as a key code for entries marked to start with 0. See
description of encodePayloadAsBinary.</li>
<li><strong>Parameters</strong><ul>
<li><code>Buffer</code>: the buffer</li>
<li><code>String</code>: optional, the binary type</li>
<li><code>Function</code>: callback, returns the decoded packet (<code>cb(Object)</code>)</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="browser">Browser</h3>
<ul>
<li><code>encodePayloadAsArrayBuffer</code><ul>
<li>Encodes multiple messages (payload) as binary.</li>
<li><strong>Parameters</strong><ul>
<li><code>Array</code>: an array of packets</li>
<li><code>Function</code>: callback, returns the encoded payload (<code>cb(ArrayBuffer)</code>)</li>
</ul>
</li>
</ul>
</li>
<li><code>encodePayloadAsBlob</code><ul>
<li>Encodes multiple messages (payload) as blob.</li>
<li><strong>Parameters</strong><ul>
<li><code>Array</code>: an array of packets</li>
<li><code>Function</code>: callback, returns the encoded payload (<code>cb(Blob)</code>)</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="tests">Tests</h2>
<p>Standalone tests can be run with <code>make test</code> which will run both node.js and browser tests.</p>
<p>Browser tests are run using <a href="https://github.com/defunctzombie/zuul">zuul</a>.
(You must have zuul setup with a saucelabs account.)</p>
<p>You can run the tests locally using the following command:</p>
<pre><code>./node_modules/.bin/zuul --local 8080 -- test/index.js
</code></pre><h2 id="support">Support</h2>
<p>The support channels for <code>engine.io-parser</code> are the same as <code>socket.io</code>:</p>
<ul>
<li>irc.freenode.net <strong>#socket.io</strong></li>
<li><a href="http://groups.google.com/group/socket_io">Google Groups</a></li>
<li><a href="http://socket.io">Website</a></li>
</ul>
<h2 id="development">Development</h2>
<p>To contribute patches, run tests or benchmarks, make sure to clone the
repository:</p>
<pre><code class="lang-bash">git clone git://github.com/LearnBoost/engine.io-parser.git
</code></pre>
<p>Then:</p>
<pre><code class="lang-bash">cd engine.io-parser
npm install
</code></pre>
<p>See the <code>Tests</code> section above for how to run tests before submitting any patches.</p>
<h2 id="license">License</h2>
<p>MIT</p>

      </body>
    </html>