"use strict";var __extends=this&&this.__extends||function(){var s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,e){r.__proto__=e}||function(r,e){for(var t in e)e.hasOwnProperty(t)&&(r[t]=e[t])};return function(r,e){function t(){this.constructor=r}s(r,e),r.prototype=null===e?Object.create(e):(t.prototype=e.prototype,new t)}}();Object.defineProperty(exports,"__esModule",{value:!0});var Observable_1=require("../Observable"),subscribeToResult_1=require("../util/subscribeToResult"),OuterSubscriber_1=require("../OuterSubscriber"),UsingObservable=function(s){function t(r,e){var t=s.call(this)||this;return t.resourceFactory=r,t.observableFactory=e,t}return __extends(t,s),t.create=function(r,e){return new t(r,e)},t.prototype._subscribe=function(e){var r,t=this.resourceFactory,s=this.observableFactory;try{return r=t(),new UsingSubscriber(e,r,s)}catch(r){e.error(r)}},t}(Observable_1.Observable);exports.UsingObservable=UsingObservable;var UsingSubscriber=function(o){function r(r,e,t){var s=o.call(this,r)||this;return s.resource=e,s.observableFactory=t,r.add(e),s.tryUse(),s}return __extends(r,o),r.prototype.tryUse=function(){try{var r=this.observableFactory.call(this,this.resource);r&&this.add(subscribeToResult_1.subscribeToResult(this,r))}catch(r){this._error(r)}},r}(OuterSubscriber_1.OuterSubscriber);