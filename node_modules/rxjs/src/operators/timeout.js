"use strict";function timeout(t,e){void 0===e&&(e=async_1.async);var r=isDate_1.isDate(t),i=r?+t-e.now():Math.abs(t);return function(t){return t.lift(new TimeoutOperator(i,r,e,new TimeoutError_1.TimeoutError))}}var __extends=this&&this.__extends||function(){var i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(t,e){function r(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}();Object.defineProperty(exports,"__esModule",{value:!0});var async_1=require("../scheduler/async"),isDate_1=require("../util/isDate"),Subscriber_1=require("../Subscriber"),TimeoutError_1=require("../util/TimeoutError");exports.timeout=timeout;var TimeoutOperator=function(){function t(t,e,r,i){this.waitFor=t,this.absoluteTimeout=e,this.scheduler=r,this.errorInstance=i}return t.prototype.call=function(t,e){return e.subscribe(new TimeoutSubscriber(t,this.absoluteTimeout,this.waitFor,this.scheduler,this.errorInstance))},t}(),TimeoutSubscriber=function(s){function e(t,e,r,i,o){var u=s.call(this,t)||this;return u.absoluteTimeout=e,u.waitFor=r,u.scheduler=i,u.errorInstance=o,u.action=null,u.scheduleTimeout(),u}return __extends(e,s),e.dispatchTimeout=function(t){t.error(t.errorInstance)},e.prototype.scheduleTimeout=function(){var t=this.action;t?this.action=t.schedule(this,this.waitFor):this.add(this.action=this.scheduler.schedule(e.dispatchTimeout,this.waitFor,this))},e.prototype._next=function(t){this.absoluteTimeout||this.scheduleTimeout(),s.prototype._next.call(this,t)},e.prototype._unsubscribe=function(){this.action=null,this.scheduler=null,this.errorInstance=null},e}(Subscriber_1.Subscriber);